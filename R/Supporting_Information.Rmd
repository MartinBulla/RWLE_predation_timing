---
title: "Sample sizes for uniparental project including some biparental data"
author: "Martin Bulla"
date: "`r Sys.time()`"
output: 
    html_document: 
        toc: true
        toc_depth: 6
        code_folding: hide
#bibliography: many_analysts.xml
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(warning=FALSE, message = FALSE)
```
***

SETTINGS and load DATA code
```{r tootl,results="hide"}
  Sys.setenv(TZ="UTC") # set time to UTC to have always same time
  warn_off = FALSE #TRUE
  load_from = "comp" # "google" #  load the data from comp (computer) or from google (googlesheets) 
  #load_from =   "google" #  load the data from comp (computer) or from google (googlesheets) 
  
  require(here)
  source(here::here('R/utils.R'))

  packages = c('anytime','data.table', 'DataEntry.validation', 'DT', 'foreach', 'ggplot2', 'ggthemes', 'glue','googledrive', 'googlesheets4', 'grid', 'htmlTable','kableExtra', 'lattice', 'lubridate', 'magrittr', 'maptools', 'plyr','raster','RColorBrewer','rmarkdown','rmdformats','readxl', 'rgeos', 'rgdal', 'rworldmap', 'rworldxtra','stringr','zoo')
  sapply(packages, function(x) suppressPackageStartupMessages(using(x)) )
  #devtools::install_github("mpio-be/DataEntry.validation", build_vignettes=TRUE)
  
  # define colors
      col_p="gray53"  # color of point's outline
  		col_pb="gray98"  # color of point's background
  		col_l="gray73"  # line color of prediction '#FCB42C'
  		col_lb="gray92"  # line color of prediction '#FCB42C'
  				
  		wr_col="grey50"
  		ln_col="grey80" 
  		
  	# load map and define projection
  		load(here::here('Data/map_rasterezid_projected.Rdata'))	# 0.1 res
  		p4s_latlon = CRS("+proj=longlat +datum=WGS84")
  		p4s = "+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=-72 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +wktext  +no_defs"

# get data, backup and load 
    if(load_from == 'google'){source(here::here('R/DB_backup.R'))}
    
    fd = c(list.files(here::here('Data'), pattern = 'DB_20', recursive = TRUE, full.names = TRUE))
    load(fd) 
    
    setnames(sp,'abb','species')
     
    u = merge(x = u, y =s[,.(abb, lat, lon)], by.x = 'site', by.y = 'abb', all.x = TRUE)
    ux = u[!quality%in%c('none','await')]
  	us = u
		us = merge(x = us, y =sp[,.(species, common, scientific, incubation)], by.x = 'species', by.y = 'species', all.x = TRUE)

		uu = us[!quality%in%c('none','await')]
	  uu = uu[!incubation%in%c('both')]

	  b = uu[, .(N_nests = .N, N_days = sum(days)), by = list(site, species, scientific, lat, lon)]
	    setorder(b, -N_nests)
			
		b[, sp_site := .N, by = site]	

		pls = merge(x = pl, y =sp[,.(species, common, scientific, incubation)], by.x = 'scientific', by.y = 'scientific', all.x=TRUE)
		pls[, sp_site := .N, by = site]
# ADD COLORS
	#n = length(unique(b$species)) #unique(b$species)[order(unique(b$species))]
	sp_ = unique(c(b$scientific,pls$scientific))
	sp_ = sp_[order(sp_)]
	n = length(sp_)
	qual_col_pals = brewer.pal.info[brewer.pal.info$category == 'qual',]
	col_ = sample(unlist(mapply(brewer.pal, qual_col_pals$maxcolors, rownames(qual_col_pals))),n)
		#col_= sample(grDevices::colors()[grep('gr(a|e)y', grDevices::colors(), invert = T)],n)
		#library(randomcoloR); col_ = distinctColorPalette(n)
		#col_ = unlist(mapply(brewer.pal, qual_col_pals$maxcolors, rownames(qual_col_pals)))
		# good color sample:	"#FFFFB3" "#E6F5C9" "#CCEBC5" "#F4CAE4" "#BEBADA" "#FDB462" "#B3E2CD" "#FFFF33" "#E41A1C" "#7FC97F" "#FFED6F" "#B3CDE3" "#666666" "#1B9E77" "#7570B3" "#FDDAEC" "#FB8072" "#F0027F" "#FFFF99" "#D9D9D9" "#E78AC3" "#A6D854" "#E31A1C" "#FF7F00" "#377EB8" "#386CB0" "#FFD92F"
		#col_[25] = "#428bc7"
	#pie(rep(1,length(col_)), col=col_)
	d = data.table(scientific = sp_, col_ = col_, stringsAsFactors=FALSE)
	#save(file = 'Data/cols.Rdata', d)
	b = merge(b,d, all.x = TRUE)
	pls = merge(pls,d,all.x = TRUE)

# change breeding locations to plotable coordinates 
	# have
		b[, lat_j := ifelse(sp_site ==1, lat, jitter(lat,amount=2))]
		b[site%in%b[sp_site>3, unique(site)], lat_j := jitter(lat_j,amount=2) ]
		b[, lon_j := lon]

		j = b
		coordinates(j) = ~ lon_j+lat_j
		proj4string(j) = p4s_latlon
		jt = spTransform(j, CRS(p4s))
		
		n = b	
		coordinates(n) = ~ lon+lat
		proj4string(n) = p4s_latlon
		nt = spTransform(n, CRS(p4s))

	# to be
		pls[, lat_j := ifelse(sp_site ==1, lat, jitter(lat,amount=2))]
		pls[site%in%b[sp_site>3, unique(site)], lat_j := jitter(lat_j,amount=2) ]
		pls[, lon_j := lon]

		jj = pls
		coordinates(jj) = ~ lon_j+lat_j
		proj4string(jj) = p4s_latlon
		jjt = spTransform(jj, CRS(p4s))
		
		nn = pls	
		coordinates(nn) = ~ lon+lat
		proj4string(nn) = p4s_latlon
		nnt = spTransform(nn, CRS(p4s))

	# to be aim and have+
		plss = pls[status %in% c("collect", "have+")]
		plss[, lat_j := ifelse(sp_site ==1, lat, jitter(lat,amount=2))]
		plss[site%in%b[sp_site>3, unique(site)], lat_j := jitter(lat_j,amount=2) ]
		plss[, lon_j := lon]

		jjs = plss
		coordinates(jjs) = ~ lon_j+lat_j
		proj4string(jjs) = p4s_latlon
		jjst = spTransform(jjs, CRS(p4s))

	# to share
		plsd = pls[status %in% c("share")]
		plsd[, lat_j := ifelse(sp_site ==1, lat, jitter(lat,amount=2))]
		plsd[site%in%b[sp_site>3, unique(site)], lat_j := jitter(lat_j,amount=2) ]
		plsd[, lon_j := lon]

		jjd = plsd
		coordinates(jjd) = ~ lon_j+lat_j
		proj4string(jjd) = p4s_latlon
		jjdt = spTransform(jjd, CRS(p4s))	

	# ??
		plq = pls[status %in% c("??")]
		plq[, lat_j := ifelse(sp_site ==1, lat, jitter(lat,amount=2))]
		plq[site%in%b[sp_site>3, unique(site)], lat_j := jitter(lat_j,amount=2) ]
		plq[, lon_j := lon]

		jjq = plq
		coordinates(jjq) = ~ lon_j+lat_j
		proj4string(jjq) = p4s_latlon
		jjqt = spTransform(jjq, CRS(p4s))		

    
```

***

#### We have touched #### 

- `r nrow(u)` nests of which `r nrow(ux)` provide some data (of which `r nrow(us)` nests are of uniparental species) from
- `r length(unique(u$species[!u$quality%in%c('none','await')]))` species of which `r length(unique(u$species[!(u$quality%in%c('none','await') | u$species %in% c('BLGO', 'NOLA', 'WOSA'))]))` species are uniparental or semi-uniparental
- the number of recorded days is centered around `r median(uu$days)` and skewed toward more days:
``` {r results = "show"}
summary(uu$days)
```

#### We have following number of nests and species to #### 

- estimate period of the rhythm: `r nrow(uu[period == 'y'])` nests from `r length(uu[period == 'y', unique(species)])`
- calculate some measure of constany: `r nrow(uu[constancy == 'y'])` nests from `r length(uu[constancy == 'y', unique(species)])`
- estimate time of depredation: `r nrow(ux[pred_time == 'y'])` nests from `r length(ux[pred_time == 'y', unique(species)])`
- estimate depredation period: `r nrow(ux[pred_per == 'y'])` nests from `r length(ux[pred_per == 'y', unique(species)])`
- estimate time of leaving: `r nrow(ux[leave_time == 'y'])` nests from `r length(ux[leave_time == 'y', unique(species)])`
- estimate hatch-leave period: `r nrow(ux[hatch_leave == 'y'])` nests from `r length(ux[hatch_leave == 'y', unique(species)])`



### DISTRIBUTIONS - MAPS
LEGEND for all MAPS  
Collected - data in house  
Aimed - loggers with collaborators or our planned field work  
Have+ - data in house, but we hope to get more  
Share - data that others can share with us  
?? - uncertain data collection

```{r prep_map_all, results = 'hide' }

  pls[status == "collect", pch := 22]
	pls[status == "have+", pch := 23]
	pls[status == "share", pch := 24]
	pls[status == "??", pch := 25]

	leg_ = b[!duplicated(species)]
	leg = pls[!duplicated(species)]
	
	png(file = here::here('Output/map_unipar_overview.png'), width=9,height=6, units="in",res=600)
	par(mar=c(0.7,0.7,0.7,1.2*8), bty="n",bg="transparent", xpd=TRUE) #mgp=c(2,0.5,0)
	plot(w, axes = F, col = 'lightgrey', legend=F)
		# collected sites
			#symbols(nt, circles=sqrt(b$N_nests/pi),inches=0.14/1.75,bg=b$col_, fg=col_p,add=TRUE) 
			#points(nt,  bg = as.character(n$col_), pch=21, cex = sqrt((b$N_nests/max(b$N_nests))*16/pi))#cex = 1.3,
			points(jt, col = "black", bg = as.character(b$col_), pch=21, cex = sqrt((b$N_nests/max(b$N_nests))*16/pi))#cex = 1.3,
			#points(jt, cex = 1.1, bg = as.character(j$col_),pch=21)# 
		# to be collected in 2020
			points(jjt, col = col_p, bg = as.character(pls$col_), pch=pls$pch, cex = 0.7)
			 
	
	legend(x=20500000, y=17000000,legend=c(1, 15, 30), pch=21, cex=0.5, pt.cex=sqrt((c(1,15,30)/max(b$N_nests))*16/pi), pt.bg=col_pb, col=col_p, title="Nests", horiz=FALSE,bty="n", xpd = TRUE, text.col = wr_col, x.intersp =1.5, title.adj = 0)#, y.intersp = 1.5)


	legend(x=22500000, y=17000000,legend=c("Collected", "Aimed", "Have+", "Share","??"), pch=c(21, 22, 23, 24,25), cex=0.5, pt.cex=1, pt.bg = col_pb, col=c("black",col_p,col_p,col_p,col_p), title="Data type", horiz=FALSE,bty="n", xpd = TRUE, text.col = wr_col, title.adj = 0)
	#legend(x=23000000, y=17000000,legend=c("Collected", "Aimed", "Old"), pch=c(21, 22, 23), cex=0.5, pt.cex=1, pt.bg=col_pb, col=col_p, title="Data type", horiz=FALSE,bty="n", xpd = TRUE, text.col = wr_col, title.adj = 0)#, y.intersp = 1.5)

	legend(x=20500000, y=12500000,legend=leg_$scientific, pch=21, cex=0.5,pt.cex=1, pt.bg=leg_$col_, col='black', title="Species - collected", horiz=FALSE,bty="n", xpd = TRUE, text.col = wr_col, title.adj = 0) #y=14000000
	
	legend(x=27000000, y=12500000,legend=leg$scientific, pch=21, cex=0.5,pt.cex=1, pt.bg=leg$col_, col=col_p, title="planned", horiz=FALSE,bty="n", xpd = TRUE, text.col = wr_col,title.adj = 0)
  dev.off()
```
#### Map all data: ####   
  ![](`r here::here('Output/map_unipar_overview.png')`)

```{r prep_map_house, results = 'hide' }

  leg_ = b[!duplicated(species)]

	png(file = here::here('Output/map_unipar_in-house-data.png'), width=9,height=6,, units="in",res=600)
	par(mar=c(0.7,0.7,0.7,1.2*8), bty="n",bg="transparent", xpd=TRUE) #mgp=c(2,0.5,0)
	plot(w, axes = F, col = 'lightgrey', legend=F)
		# collected sites
			#symbols(nt, circles=sqrt(b$N_nests/pi),inches=0.14/1.75,bg=b$col_, fg=col_p,add=TRUE) 
			#points(nt,  bg = as.character(n$col_), pch=21, cex = sqrt((b$N_nests/max(b$N_nests))*16/pi))#cex = 1.3,
			points(jt, col = "black", bg = as.character(b$col_), pch=21, cex = sqrt((b$N_nests/max(b$N_nests))*16/pi))#cex = 1.3,
			#points(jt, cex = 1.1, bg = as.character(j$col_),pch=21)# 
		
	legend(x=20500000, y=17000000,legend=c(1, 15, 30), pch=21, cex=0.5, pt.cex=sqrt((c(1,15,30)/max(b$N_nests))*16/pi), pt.bg=col_pb, col=col_p, title="Nests", horiz=FALSE,bty="n", xpd = TRUE, text.col = wr_col, x.intersp =1.5, title.adj = 0)#, y.intersp = 1.5)

	legend(x=20500000, y=12500000,legend=leg_$scientific, pch=21, cex=0.5,pt.cex=1, pt.bg=leg_$col_, col='black', title="Species - collected", horiz=FALSE,bty="n", xpd = TRUE, text.col = wr_col, title.adj = 0) #y=14000000\
	dev.off()
```
#### Map in house data: ####   
  ![](`r here::here('Output/map_unipar_in-house-data.png')`)

```{r prep_plan, results = 'hide' }

  pls[status == "collect",c("pch", "col_o") := list(21, 'black')]
	pls[status == "have+",c("pch", "col_o") := 	 list(22, col_p)]
	pls[status == "share",c("pch", "col_o") :=   list(23, col_p)]
	pls[status == "??",c("pch", "col_o") :=      list(24, col_p)]

	leg = pls[!duplicated(species)]

	png(file = here::here('Output/map_unipar_plan.png'), width=9,height=6, units="in",res=600)
	par(mar=c(0.7,0.7,0.7,1.2*8), bty="n",bg="transparent", xpd=TRUE) #mgp=c(2,0.5,0)
	plot(w, axes = F, col = 'lightgrey', legend=F)
		points(jjt, col = pls$col_o, bg = pls$col_, pch=pls$pch, cex = 0.8)
			 	
	legend(x=20500000, y=17000000,legend=c(1, 15, 30), pch=21, cex=0.5, pt.cex=sqrt((c(1,15,30)/max(b$N_nests))*16/pi), pt.bg=col_pb, col=col_p, title="Nests", horiz=FALSE,bty="n", xpd = TRUE, text.col = wr_col, x.intersp =1.5, title.adj = 0)#, y.intersp = 1.5)

	legend(x=22500000, y=17000000,legend=c("Aimed", "Have+", "Share","??"), pch=c(21, 22, 23, 24), cex=0.5, pt.cex=1, pt.bg = col_pb, col=c("black",col_p,col_p,col_p), title="Data type", horiz=FALSE,bty="n", xpd = TRUE, text.col = wr_col, title.adj = 0)
	#legend(x=23000000, y=17000000,legend=c("Collected", "Aimed", "Old"), pch=c(21, 22, 23), cex=0.5, pt.cex=1, pt.bg=col_pb, col=col_p, title="Data type", horiz=FALSE,bty="n", xpd = TRUE, text.col = wr_col, title.adj = 0)#, y.intersp = 1.5)

	legend(x=20500000, y=12500000,legend=leg$scientific, pch=21, cex=0.5,pt.cex=1, pt.bg=leg$col_, col=col_p, title="Species planned", horiz=FALSE,bty="n", xpd = TRUE, text.col = wr_col,title.adj = 0)

	dev.off()
```
#### Map plan: ####   
  ![](`r here::here('Output/map_unipar_plan.png')`)

```{r prep_share, results = 'hide' }

  plsd[status == "share",c("pch", "col_o") := list(21, 'black')]
	leg = plsd[!duplicated(species)]

  png(file = here::here('Output/map_unipar_share.png'), width=9,height=6, units="in",res=600)
	par(mar=c(0.7,0.7,0.7,1.2*8), bty="n",bg="transparent", xpd=TRUE) #mgp=c(2,0.5,0)
	plot(w, axes = F, col = 'lightgrey', legend=F)
		points(jjdt, col = plsd$col_o, bg = plsd$col_, pch=plsd$pch, cex = 0.8)
			 	
	legend(x=20500000, y=17000000,legend=c(1, 15, 30), pch=21, cex=0.5, pt.cex=sqrt((c(1,15,30)/max(b$N_nests))*16/pi), pt.bg=col_pb, col=col_p, title="Nests", horiz=FALSE,bty="n", xpd = TRUE, text.col = wr_col, x.intersp =1.5, title.adj = 0)#, y.intersp = 1.5)

	legend(x=20500000, y=12500000,legend=leg$scientific, pch=21, cex=0.5,pt.cex=1, pt.bg=leg$col_, col=col_p, title="Species to share", horiz=FALSE,bty="n", xpd = TRUE, text.col = wr_col,title.adj = 0)


	dev.off()
```
#### Map share: ####   
  ![](`r here::here('Output/map_unipar_share.png')`)

```{r prep_??, results = 'hide' }

	plq[status == "??",c("pch", "col_o") := list(21, 'black')]
	leg = plq[!duplicated(species)]

	png(file = here::here('Output/map_unipar_uncertain.png'), width=9,height=6, units="in",res=600)
	par(mar=c(0.7,0.7,0.7,1.2*8), bty="n",bg="transparent", xpd=TRUE) #mgp=c(2,0.5,0)
	plot(w, axes = F, col = 'lightgrey', legend=F)
		points(jjqt, col = plq$col_o, bg = plq$col_, pch=plq$pch, cex = 0.8)
			 	
	legend(x=20500000, y=17000000,legend=c(1, 15, 30), pch=21, cex=0.5, pt.cex=sqrt((c(1,15,30)/max(b$N_nests))*16/pi), pt.bg=col_pb, col=col_p, title="Nests", horiz=FALSE,bty="n", xpd = TRUE, text.col = wr_col, x.intersp =1.5, title.adj = 0)#, y.intersp = 1.5)

	legend(x=20500000, y=12500000,legend=leg$scientific, pch=21, cex=0.5,pt.cex=1, pt.bg=leg$col_, col=col_p, title="Species to share", horiz=FALSE,bty="n", xpd = TRUE, text.col = wr_col,title.adj = 0)

	dev.off()
```
#### Map ??: ####   
  ![](`r here::here('Output/map_unipar_uncertain.png')`)

```{r prep_plan&plus, results = 'hide' }
  plss[status == "collect",c("pch", "col_o") := list(21, 'black')]
  plss[status == "have+",c("pch", "col_o") := 	 list(23, col_p)]
	leg = plss[!duplicated(species)]

png(file = here::here('Output/map_unipar_aimPlus.png'), width=9,height=6, units="in",res=600)
	par(mar=c(0.7,0.7,0.7,1.2*8), bty="n",bg="transparent", xpd=TRUE) #mgp=c(2,0.5,0)
	plot(w, axes = F, col = 'lightgrey', legend=F)
		points(jjst, col = plss$col_o, bg = plss$col_, pch=plss$pch, cex = 0.8)
			 	
	legend(x=20500000, y=17000000,legend=c(1, 15, 30), pch=21, cex=0.5, pt.cex=sqrt((c(1,15,30)/max(b$N_nests))*16/pi), pt.bg=col_pb, col=col_p, title="Nests", horiz=FALSE,bty="n", xpd = TRUE, text.col = wr_col, x.intersp =1.5, title.adj = 0)#, y.intersp = 1.5)

	legend(x=22500000, y=17000000,legend=c("Aimed", "Have+"), pch=c(21, 23), cex=0.5, pt.cex=1, pt.bg = col_pb, col=c("black",col_p), title="Data type", horiz=FALSE,bty="n", xpd = TRUE, text.col = wr_col, title.adj = 0)
	#legend(x=23000000, y=17000000,legend=c("Collected", "Aimed", "Old"), pch=c(21, 22, 23), cex=0.5, pt.cex=1, pt.bg=col_pb, col=col_p, title="Data type", horiz=FALSE,bty="n", xpd = TRUE, text.col = wr_col, title.adj = 0)#, y.intersp = 1.5)

	legend(x=20500000, y=12500000,legend=leg$scientific, pch=21, cex=0.5,pt.cex=1, pt.bg=leg$col_, col=col_p, title="Species planned", horiz=FALSE,bty="n", xpd = TRUE, text.col = wr_col,title.adj = 0)

	dev.off()
```
#### Map aim & additional: ####   
  ![](`r here::here('Output/map_unipar_aimPlus.png')`)

```{r prep_in-house&share, results = 'hide' }

  plsd[status == "share",c("pch", "col_o") := list(24, col_p)]
	leg = plsd[!duplicated(species)]
	leg_ = b[!duplicated(species)]

	png(file = here::here('Output/map_unipar_in-house_share.png'), width=9,height=6, units="in",res=600)
	par(mar=c(0.7,0.7,0.7,1.2*8), bty="n",bg="transparent", xpd=TRUE) #mgp=c(2,0.5,0)
	plot(w, axes = F, col = 'lightgrey', legend=F)
		# collected sites
			#symbols(nt, circles=sqrt(b$N_nests/pi),inches=0.14/1.75,bg=b$col_, fg=col_p,add=TRUE) 
			#points(nt,  bg = as.character(n$col_), pch=21, cex = sqrt((b$N_nests/max(b$N_nests))*16/pi))#cex = 1.3,
			points(jt, col = "black", bg = as.character(b$col_), pch=21, cex = sqrt((b$N_nests/max(b$N_nests))*16/pi))#cex = 1.3,
			#points(jt, cex = 1.1, bg = as.character(j$col_),pch=21)# 
		# to be shared
			points(jjdt, col = plsd$col_o, bg = plsd$col_, pch=plsd$pch, cex = 0.8)
			 
	
	legend(x=20500000, y=17000000,legend=c(1, 15, 30), pch=21, cex=0.5, pt.cex=sqrt((c(1,15,30)/max(b$N_nests))*16/pi), pt.bg=col_pb, col=col_p, title="Nests", horiz=FALSE,bty="n", xpd = TRUE, text.col = wr_col, x.intersp =1.5, title.adj = 0)#, y.intersp = 1.5)


	legend(x=22500000, y=17000000,legend=c("Collected", "Share"), pch=c(21, 24), cex=0.5, pt.cex=1, pt.bg = col_pb, col=c("black",col_p), title="Data type", horiz=FALSE,bty="n", xpd = TRUE, text.col = wr_col, title.adj = 0)
	#legend(x=23000000, y=17000000,legend=c("Collected", "Aimed", "Old"), pch=c(21, 22, 23), cex=0.5, pt.cex=1, pt.bg=col_pb, col=col_p, title="Data type", horiz=FALSE,bty="n", xpd = TRUE, text.col = wr_col, title.adj = 0)#, y.intersp = 1.5)

	legend(x=20500000, y=12500000,legend=leg_$scientific, pch=21, cex=0.5,pt.cex=1, pt.bg=leg_$col_, col='black', title="Species - collected", horiz=FALSE,bty="n", xpd = TRUE, text.col = wr_col, title.adj = 0) #y=14000000
	legend(x=27000000, y=12500000,legend=leg$scientific, pch=21, cex=0.5,pt.cex=1, pt.bg=leg$col_, col=col_p, title="to be shared", horiz=FALSE,bty="n", xpd = TRUE, text.col = wr_col,title.adj = 0)

	dev.off()
```
#### Map in house & share: ####   
  ![](`r here::here('Output/map_unipar_in-house_share.png')`)

***

### DISTRIBUTIONS - numbers and graphs  
``` {r results = "show"}
usx = us[ !us$quality%in%c('none','await'), .N, by = list(incubation, species)]

#knitr::kable(usx[order(incubation,species)]	, caption = "Nest per species",longtable = TRUE, booktabs = TRUE)

usx[order(incubation,species)] %>%
  kbl(caption = "Nests per species") %>%
  kable_classic(full_width = F,font_size = 9,fixed_thead = T, bootstrap_options = "striped",  position = "left")
```


#### The distribution of days across species and sites #### 
```{r fig.align="center", fig.width=10, fig.height=10}

ggplot(uu, aes(x = species,  y = days)) + geom_boxplot(aes(col = species)) + facet_wrap(~paste(round(lat,2), site), scales = 'free_x', ncol = 3)

```

***

```{r fig.align="center", fig.width=10, fig.height=10}

ggplot(uu, aes(x = factor(round(lat,2)),  y = days)) + geom_boxplot(aes(col = species)) + facet_wrap(~species, scales = 'free_x', ncol = 3)

```


#### The distribution of leaving data across species and sites #### 
```{r fig.align="center", fig.width=8, fig.height=6}

ggplot(uu[hatch_leave == 'y'], aes(x = species)) + geom_bar()+ylab('Nest with known hatch-leave')

```

***

```{r fig.align="center", fig.width=6, fig.height=6}

ggplot(uu[hatch_leave == 'y'], aes(x =paste(round(lat,2), site))) + geom_bar() +ylab('Nest with known hatch-leave') + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

```

***

#### The distribution of predation timing data across species and sites #### 
```{r fig.align="center", fig.width=4, fig.height=4}

ggplot(uu[pred_per == 'y'], aes(x = species)) + geom_bar()+ylab('Nest with known time of depredation')

```

***

```{r fig.align="center", fig.width=7, fig.height=5}

ggplot(uu[pred_per == 'y'], aes(x =paste(round(lat,2), site))) + geom_bar() +ylab('Nest with known time of depredation') + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

```

***